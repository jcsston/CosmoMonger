<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<databaseChangeLog xmlns="http://www.liquibase.org/xml/ns/dbchangelog/1.8" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog/1.8 http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-1.8.xsd">
  <changeSet author="Jory Stone" id="1">
    <comment>Create Inital Tables</comment>
    <createTable tableName="BaseShip">
      <column name="BaseShipId" type="int" autoIncrement="true">
        <constraints nullable="false" primaryKey="true" primaryKeyName="PK_BaseShip"/>
      </column>
      <column name="Model" type="varchar(255)">
        <constraints nullable="false"/>
      </column>
      <column name="BasePrice" type="int">
        <constraints nullable="false"/>
      </column>
      <column name="CargoSpace" type="int">
        <constraints nullable="false"/>
      </column>
      <column name="InitialJumpDriveId" type="int">
        <constraints nullable="false"/>
      </column>
      <column name="InitialWeaponId" type="int">
        <constraints nullable="false"/>
      </column>
      <column name="InitialShieldId" type="int">
        <constraints nullable="false"/>
      </column>
    </createTable>
    <createTable tableName="BuddyList">
      <column name="UserId" type="int">
        <constraints nullable="false"/>
      </column>
      <column name="FriendId" type="int">
        <constraints nullable="false"/>
      </column>
    </createTable>
    <createTable tableName="User">
      <column name="UserId" type="int" autoIncrement="true">
        <constraints nullable="false" primaryKey="true" primaryKeyName="PK_User"/>
      </column>
      <column name="Email" type="varchar(255)">
        <constraints nullable="false"/>
      </column>
      <column name="UserName" type="varchar(255)">
        <constraints nullable="false"/>
      </column>
      <column name="Password" type="varchar(32)">
        <constraints nullable="false"/>
      </column>
      <column defaultValueBoolean="false" name="Validated" type="bit">
        <constraints nullable="false"/>
      </column>
      <column defaultValueBoolean="true" name="Active" type="bit">
        <constraints nullable="false"/>
      </column>
      <column defaultValueBoolean="false" name="Admin" type="bit">
        <constraints nullable="false"/>
      </column>
    </createTable>
    <createTable tableName="Good">
      <column name="GoodId" type="int" autoIncrement="true">
        <constraints nullable="false" primaryKey="true" primaryKeyName="PK_Good"/>
      </column>
      <column name="Name" type="varchar(255)">
        <constraints nullable="false"/>
      </column>
      <column name="BasePrice" type="int">
        <constraints nullable="false"/>
      </column>
      <column name="Contraband" type="bit">
        <constraints nullable="false"/>
      </column>
    </createTable>
    <createTable tableName="IgnoreList">
      <column name="UserId" type="int">
        <constraints nullable="false"/>
      </column>
      <column name="AntiFriendId" type="int">
        <constraints nullable="false"/>
      </column>
    </createTable>
    <createTable tableName="InProgressCombat">
      <column name="AttackerShipId" type="int">
        <constraints nullable="false"/>
      </column>
      <column name="DefenderShipId" type="int">
        <constraints nullable="false"/>
      </column>
      <column defaultValueNumeric="0" name="Turn" type="int">
        <constraints nullable="false"/>
      </column>
      <column defaultValueNumeric="20" name="TurnPointsLeft" type="int">
        <constraints nullable="false"/>
      </column>
      <column name="Surrender" type="bit">
        <constraints nullable="false"/>
      </column>
      <column defaultValueBoolean="false" name="JettisonCargo" type="bit">
        <constraints nullable="false"/>
      </column>
    </createTable>
    <createTable tableName="JumpDrive">
      <column name="JumpDriveId" type="int" autoIncrement="true">
        <constraints nullable="false" primaryKey="true" primaryKeyName="PK_JumpDrive"/>
      </column>
      <column name="Name" type="varchar(255)">
        <constraints nullable="false"/>
      </column>
      <column name="Speed" type="int">
        <constraints nullable="false"/>
      </column>
      <column name="Range" type="int">
        <constraints nullable="false"/>
      </column>
      <column name="CargoCost" type="int">
        <constraints nullable="false"/>
      </column>
      <column name="BasePrice" type="int">
        <constraints nullable="false"/>
      </column>
    </createTable>
    <createTable tableName="Message">
      <column name="MessageId" type="int" autoIncrement="true">
        <constraints nullable="false" primaryKey="true" primaryKeyName="PK_Message"/>
      </column>
      <column name="RecipientUserId" type="int">
        <constraints nullable="false"/>
      </column>
      <column name="SenderUserId" type="int">
        <constraints nullable="false"/>
      </column>
      <column name="Content" type="TEXT">
        <constraints nullable="false"/>
      </column>
      <column name="Time" type="DATETIME">
        <constraints nullable="false"/>
      </column>
      <column defaultValueBoolean="false" name="Recieved" type="bit">
        <constraints nullable="false"/>
      </column>
    </createTable>
    <createTable tableName="Npc">
      <column name="NpcId" type="int" autoIncrement="true">
        <constraints nullable="false" primaryKey="true" primaryKeyName="PK_Npc"/>
      </column>
      <column name="NpcTypeId" type="int">
        <constraints nullable="false"/>
      </column>
      <column name="Name" type="varchar(255)">
        <constraints nullable="false"/>
      </column>
      <column name="RaceId" type="int">
        <constraints nullable="false"/>
      </column>
      <column name="ShipId" type="int">
        <constraints nullable="false"/>
      </column>
      <column name="Credits" type="int">
        <constraints nullable="false"/>
      </column>
      <column name="Badness" type="int"/>
      <column name="Bounty" type="int"/>
    </createTable>
    <createTable tableName="NpcType">
      <column name="NpcTypeId" type="int" autoIncrement="true">
        <constraints nullable="false" primaryKey="true" primaryKeyName="PK_NpcType"/>
      </column>
      <column name="Name" type="varchar(255)">
        <constraints nullable="false"/>
      </column>
    </createTable>
    <createTable tableName="Player">
      <column name="PlayerId" type="int" autoIncrement="true">
        <constraints nullable="false" primaryKey="true" primaryKeyName="PK_Player"/>
      </column>
      <column name="UserId" type="int">
        <constraints nullable="false"/>
      </column>
      <column name="Name" type="varchar(255)">
        <constraints nullable="false"/>
      </column>
      <column name="RaceId" type="int">
        <constraints nullable="false"/>
      </column>
      <column name="Reputation" type="int">
        <constraints nullable="false"/>
      </column>
      <column name="ShipId" type="int">
        <constraints nullable="false"/>
      </column>
      <column name="BankCredits" type="int">
        <constraints nullable="false"/>
      </column>
      <column name="CashCredits" type="int">
        <constraints nullable="false"/>
      </column>
      <column name="TimePlayed" type="int">
        <constraints nullable="false"/>
      </column>
      <column name="LastPlayed" type="DATETIME">
        <constraints nullable="false"/>
      </column>
      <column defaultValueNumeric="0" name="NetWorth" type="int">
        <constraints nullable="false"/>
      </column>
      <column defaultValueNumeric="0" name="BountyTotal" type="int">
        <constraints nullable="false"/>
      </column>
      <column defaultValueNumeric="0" name="HighestBounty" type="int">
        <constraints nullable="false"/>
      </column>
      <column defaultValueNumeric="0" name="ShipsDestroyed" type="int">
        <constraints nullable="false"/>
      </column>
      <column defaultValueNumeric="0" name="ForcedSurrenders" type="int">
        <constraints nullable="false"/>
      </column>
      <column defaultValueNumeric="0" name="ForcedFlees" type="int">
        <constraints nullable="false"/>
      </column>
      <column defaultValueNumeric="0" name="CargoLootedWorth" type="int">
        <constraints nullable="false"/>
      </column>
      <column defaultValueNumeric="0" name="ShipsLost" type="int">
        <constraints nullable="false"/>
      </column>
      <column defaultValueNumeric="0" name="SurrenderCount" type="int">
        <constraints nullable="false"/>
      </column>
      <column defaultValueNumeric="0" name="FleeCount" type="int">
        <constraints nullable="false"/>
      </column>
      <column defaultValueNumeric="0" name="CargoLostWorth" type="int">
        <constraints nullable="false"/>
      </column>
      <column defaultValueBoolean="true" name="Alive" type="bit">
        <constraints nullable="false"/>
      </column>
    </createTable>
    <createTable tableName="Race">
      <column name="RaceId" type="int" autoIncrement="true">
        <constraints nullable="false" primaryKey="true" primaryKeyName="PK_Race"/>
      </column>
      <column name="Name" type="varchar(255)">
        <constraints nullable="false"/>
      </column>
      <column name="Weapons" type="int">
        <constraints nullable="false"/>
      </column>
      <column name="Shields" type="int">
        <constraints nullable="false"/>
      </column>
      <column name="Engine" type="int">
        <constraints nullable="false"/>
      </column>
    </createTable>
    <createTable tableName="Shield">
      <column name="ShieldId" type="int" autoIncrement="true">
        <constraints nullable="false" primaryKey="true" primaryKeyName="PK_Shield"/>
      </column>
      <column name="Name" type="varchar(255)">
        <constraints nullable="false"/>
      </column>
      <column name="Strength" type="int">
        <constraints nullable="false"/>
      </column>
      <column name="BasePrice" type="int">
        <constraints nullable="false"/>
      </column>
    </createTable>
    <createTable tableName="Ship">
      <column name="ShipId" type="int" autoIncrement="true">
        <constraints nullable="false" primaryKey="true" primaryKeyName="PK_Ship"/>
      </column>
      <column name="BaseShipId" type="int">
        <constraints nullable="false"/>
      </column>
      <column name="SystemId" type="int">
        <constraints nullable="false"/>
      </column>
      <column name="WeaponId" type="int">
        <constraints nullable="false"/>
      </column>
      <column name="JumpDriveId" type="int">
        <constraints nullable="false"/>
      </column>
      <column name="ShieldId" type="int">
        <constraints nullable="false"/>
      </column>
      <column name="DamageEngine" type="int">
        <constraints nullable="false"/>
      </column>
      <column name="DamageWeapon" type="int">
        <constraints nullable="false"/>
      </column>
      <column name="DamageShield" type="int">
        <constraints nullable="false"/>
      </column>
      <column name="DamageHull" type="int">
        <constraints nullable="false"/>
      </column>
      <column name="TargetSystemId" type="int"/>
      <column name="CurrentJumpDriveCharge" type="int"/>
    </createTable>
    <createTable tableName="ShipGood">
      <column name="ShipId" type="int">
        <constraints nullable="false"/>
      </column>
      <column name="GoodId" type="int">
        <constraints nullable="false"/>
      </column>
      <column name="Quantity" type="int">
        <constraints nullable="false"/>
      </column>
    </createTable>
    <createTable tableName="System">
      <column name="SystemId" type="int" autoIncrement="true">
        <constraints nullable="false" primaryKey="true" primaryKeyName="PK_System"/>
      </column>
      <column name="Name" type="varchar(255)">
        <constraints nullable="false"/>
      </column>
      <column name="PositionX" type="int">
        <constraints nullable="false"/>
      </column>
      <column name="PositionY" type="int">
        <constraints nullable="false"/>
      </column>
      <column name="HasBank" type="bit">
        <constraints nullable="false"/>
      </column>
    </createTable>
    <createTable tableName="SystemGood">
      <column name="SystemId" type="int">
        <constraints nullable="false"/>
      </column>
      <column name="GoodId" type="int">
        <constraints nullable="false"/>
      </column>
      <column name="Quantity" type="int">
        <constraints nullable="false"/>
      </column>
      <column name="PriceMultiplier" type="float(15,0)">
        <constraints nullable="false"/>
      </column>
    </createTable>
    <createTable tableName="SystemJumpDriveUpgrade">
      <column name="SystemId" type="int">
        <constraints nullable="false"/>
      </column>
      <column name="JumpDriveId" type="int">
        <constraints nullable="false"/>
      </column>
      <column name="Quantity" type="int">
        <constraints nullable="false"/>
      </column>
      <column name="PriceMultiplier" type="float(15,0)">
        <constraints nullable="false"/>
      </column>
    </createTable>
    <createTable tableName="SystemShieldUpgrade">
      <column name="SystemId" type="int">
        <constraints nullable="false"/>
      </column>
      <column name="ShieldId" type="int">
        <constraints nullable="false"/>
      </column>
      <column name="Quantity" type="int">
        <constraints nullable="false"/>
      </column>
      <column name="PriceMultiplier" type="float(15,0)">
        <constraints nullable="false"/>
      </column>
    </createTable>
    <createTable tableName="SystemShip">
      <column name="SystemId" type="int">
        <constraints nullable="false"/>
      </column>
      <column name="BaseShipId" type="int">
        <constraints nullable="false"/>
      </column>
      <column name="Quantity" type="int">
        <constraints nullable="false"/>
      </column>
      <column name="PriceMultiplier" type="float(15,0)">
        <constraints nullable="false"/>
      </column>
    </createTable>
    <createTable tableName="SystemWeaponUpgrade">
      <column name="SystemId" type="int">
        <constraints nullable="false"/>
      </column>
      <column name="WeaponId" type="int">
        <constraints nullable="false"/>
      </column>
      <column name="Quantity" type="int">
        <constraints nullable="false"/>
      </column>
      <column name="PriceMultiplier" type="float(15,0)">
        <constraints nullable="false"/>
      </column>
    </createTable>
    <createTable tableName="Weapon">
      <column name="WeaponId" type="int" autoIncrement="true">
        <constraints nullable="false" primaryKey="true" primaryKeyName="PK_Weapon"/>
      </column>
      <column name="Name" type="varchar(255)">
        <constraints nullable="false"/>
      </column>
      <column name="Power" type="int">
        <constraints nullable="false"/>
      </column>
      <column name="TurnCost" type="int">
        <constraints nullable="false"/>
      </column>
      <column name="CargoCost" type="int">
        <constraints nullable="false"/>
      </column>
      <column name="BasePrice" type="int">
        <constraints nullable="false"/>
      </column>
    </createTable>
  </changeSet>
  <changeSet author="Jory Stone" id="2">
    <comment>Create Composite Primary Keys</comment>
    <addPrimaryKey columnNames="UserId, FriendId" constraintName="PK_BuddyList" tableName="BuddyList"/>
    <addPrimaryKey columnNames="UserId, AntiFriendId" constraintName="PK_IgnoreList" tableName="IgnoreList"/>
    <addPrimaryKey columnNames="AttackerShipId, DefenderShipId" constraintName="PK_InProgressCombatK" tableName="InProgressCombat"/>
    <addPrimaryKey columnNames="GoodId, ShipId" constraintName="PK_ShipGood" tableName="ShipGood"/>
    <addPrimaryKey columnNames="GoodId, SystemId" constraintName="PK_SystemGood" tableName="SystemGood"/>
    <addPrimaryKey columnNames="JumpDriveId, SystemId" constraintName="PK_SystemJumpDriveUpgrade" tableName="SystemJumpDriveUpgrade"/>
    <addPrimaryKey columnNames="ShieldId, SystemId" constraintName="PK_SystemShieldUpgrade" tableName="SystemShieldUpgrade"/>
    <addPrimaryKey columnNames="BaseShipId, SystemId" constraintName="PK_SystemShip" tableName="SystemShip"/>
    <addPrimaryKey columnNames="WeaponId, SystemId" constraintName="PK_SystemWeaponUpgrade" tableName="SystemWeaponUpgrade"/>
  </changeSet>
  <changeSet author="Jory Stone" id="3">
    <comment>Create Foreign Key Constraints</comment>
    <addForeignKeyConstraint baseColumnNames="InitialJumpDriveId" baseTableName="BaseShip" constraintName="FK_JumpDrive_BaseShip" deferrable="false" initiallyDeferred="false" onDelete="RESTRICT" onUpdate="RESTRICT" referencedColumnNames="JumpDriveId" referencedTableName="JumpDrive"/>
    <addForeignKeyConstraint baseColumnNames="InitialShieldId" baseTableName="BaseShip" constraintName="FK_Shield_BaseShip" deferrable="false" initiallyDeferred="false" onDelete="RESTRICT" onUpdate="RESTRICT" referencedColumnNames="ShieldId" referencedTableName="Shield"/>
    <addForeignKeyConstraint baseColumnNames="InitialWeaponId" baseTableName="BaseShip" constraintName="FK_Weapon_BaseShip" deferrable="false" initiallyDeferred="false" onDelete="RESTRICT" onUpdate="RESTRICT" referencedColumnNames="WeaponId" referencedTableName="Weapon"/>
    <addForeignKeyConstraint baseColumnNames="FriendId" baseTableName="BuddyList" constraintName="FK_User_BuddyList_2" deferrable="false" initiallyDeferred="false" onDelete="RESTRICT" onUpdate="RESTRICT" referencedColumnNames="UserId" referencedTableName="User"/>
    <addForeignKeyConstraint baseColumnNames="UserId" baseTableName="BuddyList" constraintName="FK_User_BuddyList_1" deferrable="false" initiallyDeferred="false" onDelete="RESTRICT" onUpdate="RESTRICT" referencedColumnNames="UserId" referencedTableName="User"/>
    <addForeignKeyConstraint baseColumnNames="AntiFriendId" baseTableName="IgnoreList" constraintName="FK_User_IgnoreList_2" deferrable="false" initiallyDeferred="false" onDelete="RESTRICT" onUpdate="RESTRICT" referencedColumnNames="UserId" referencedTableName="User"/>
    <addForeignKeyConstraint baseColumnNames="UserId" baseTableName="IgnoreList" constraintName="FK_User_IgnoreList_1" deferrable="false" initiallyDeferred="false" onDelete="RESTRICT" onUpdate="RESTRICT" referencedColumnNames="UserId" referencedTableName="User"/>
    <addForeignKeyConstraint baseColumnNames="AttackerShipId" baseTableName="InProgressCombat" constraintName="FK_Ship_InProgressCombat_1" deferrable="false" initiallyDeferred="false" onDelete="RESTRICT" onUpdate="RESTRICT" referencedColumnNames="ShipId" referencedTableName="Ship"/>
    <addForeignKeyConstraint baseColumnNames="DefenderShipId" baseTableName="InProgressCombat" constraintName="FK_Ship_InProgressCombat_2" deferrable="false" initiallyDeferred="false" onDelete="RESTRICT" onUpdate="RESTRICT" referencedColumnNames="ShipId" referencedTableName="Ship"/>
    <addForeignKeyConstraint baseColumnNames="RecipientUserId" baseTableName="Message" constraintName="FK_User_Message_2" deferrable="false" initiallyDeferred="false" onDelete="RESTRICT" onUpdate="RESTRICT" referencedColumnNames="UserId" referencedTableName="User"/>
    <addForeignKeyConstraint baseColumnNames="SenderUserId" baseTableName="Message" constraintName="FK_User_Message_1" deferrable="false" initiallyDeferred="false" onDelete="RESTRICT" onUpdate="RESTRICT" referencedColumnNames="UserId" referencedTableName="User"/>
    <addForeignKeyConstraint baseColumnNames="NpcTypeId" baseTableName="Npc" constraintName="FK_NpcType_Npc" deferrable="false" initiallyDeferred="false" onDelete="RESTRICT" onUpdate="RESTRICT" referencedColumnNames="NpcTypeId" referencedTableName="NpcType"/>
    <addForeignKeyConstraint baseColumnNames="RaceId" baseTableName="Npc" constraintName="FK_Race_Npc" deferrable="false" initiallyDeferred="false" onDelete="RESTRICT" onUpdate="RESTRICT" referencedColumnNames="RaceId" referencedTableName="Race"/>
    <addForeignKeyConstraint baseColumnNames="ShipId" baseTableName="Npc" constraintName="FK_Ship_Npc" deferrable="false" initiallyDeferred="false" onDelete="RESTRICT" onUpdate="RESTRICT" referencedColumnNames="ShipId" referencedTableName="Ship"/>
    <addForeignKeyConstraint baseColumnNames="RaceId" baseTableName="Player" constraintName="FK_Race_Player" deferrable="false" initiallyDeferred="false" onDelete="RESTRICT" onUpdate="RESTRICT" referencedColumnNames="RaceId" referencedTableName="Race"/>
    <addForeignKeyConstraint baseColumnNames="ShipId" baseTableName="Player" constraintName="FK_Ship_Player" deferrable="false" initiallyDeferred="false" onDelete="RESTRICT" onUpdate="RESTRICT" referencedColumnNames="ShipId" referencedTableName="Ship"/>
    <addForeignKeyConstraint baseColumnNames="UserId" baseTableName="Player" constraintName="FK_User_Player" deferrable="false" initiallyDeferred="false" onDelete="RESTRICT" onUpdate="RESTRICT" referencedColumnNames="UserId" referencedTableName="User"/>
    <addForeignKeyConstraint baseColumnNames="BaseShipId" baseTableName="Ship" constraintName="FK_BaseShip_Ship" deferrable="false" initiallyDeferred="false" onDelete="RESTRICT" onUpdate="RESTRICT" referencedColumnNames="BaseShipId" referencedTableName="BaseShip"/>
    <addForeignKeyConstraint baseColumnNames="JumpDriveId" baseTableName="Ship" constraintName="FK_JumpDrive_Ship" deferrable="false" initiallyDeferred="false" onDelete="RESTRICT" onUpdate="RESTRICT" referencedColumnNames="JumpDriveId" referencedTableName="JumpDrive"/>
    <addForeignKeyConstraint baseColumnNames="ShieldId" baseTableName="Ship" constraintName="FK_Shield_Ship" deferrable="false" initiallyDeferred="false" onDelete="RESTRICT" onUpdate="RESTRICT" referencedColumnNames="ShieldId" referencedTableName="Shield"/>
    <addForeignKeyConstraint baseColumnNames="SystemId" baseTableName="Ship" constraintName="FK_System_Ship" deferrable="false" initiallyDeferred="false" onDelete="RESTRICT" onUpdate="RESTRICT" referencedColumnNames="SystemId" referencedTableName="System"/>
    <addForeignKeyConstraint baseColumnNames="WeaponId" baseTableName="Ship" constraintName="FK_Weapon_Ship" deferrable="false" initiallyDeferred="false" onDelete="RESTRICT" onUpdate="RESTRICT" referencedColumnNames="WeaponId" referencedTableName="Weapon"/>
    <addForeignKeyConstraint baseColumnNames="GoodId" baseTableName="ShipGood" constraintName="FK_Good_ShipGood" deferrable="false" initiallyDeferred="false" onDelete="RESTRICT" onUpdate="RESTRICT" referencedColumnNames="GoodId" referencedTableName="Good"/>
    <addForeignKeyConstraint baseColumnNames="ShipId" baseTableName="ShipGood" constraintName="FK_Ship_ShipGood" deferrable="false" initiallyDeferred="false" onDelete="RESTRICT" onUpdate="RESTRICT" referencedColumnNames="ShipId" referencedTableName="Ship"/>
    <addForeignKeyConstraint baseColumnNames="GoodId" baseTableName="SystemGood" constraintName="FK_Good_SystemGood" deferrable="false" initiallyDeferred="false" onDelete="RESTRICT" onUpdate="RESTRICT" referencedColumnNames="GoodId" referencedTableName="Good"/>
    <addForeignKeyConstraint baseColumnNames="SystemId" baseTableName="SystemGood" constraintName="FK_System_SystemGood" deferrable="false" initiallyDeferred="false" onDelete="RESTRICT" onUpdate="RESTRICT" referencedColumnNames="SystemId" referencedTableName="System"/>
    <addForeignKeyConstraint baseColumnNames="JumpDriveId" baseTableName="SystemJumpDriveUpgrade" constraintName="FK_JumpDrive_SystemJumpDriveUpgrade" deferrable="false" initiallyDeferred="false" onDelete="RESTRICT" onUpdate="RESTRICT" referencedColumnNames="JumpDriveId" referencedTableName="JumpDrive"/>
    <addForeignKeyConstraint baseColumnNames="SystemId" baseTableName="SystemJumpDriveUpgrade" constraintName="FK_System_SystemJumpDriveUpgrade" deferrable="false" initiallyDeferred="false" onDelete="RESTRICT" onUpdate="RESTRICT" referencedColumnNames="SystemId" referencedTableName="System"/>
    <addForeignKeyConstraint baseColumnNames="ShieldId" baseTableName="SystemShieldUpgrade" constraintName="FK_Shield_SystemShieldUpgrade" deferrable="false" initiallyDeferred="false" onDelete="RESTRICT" onUpdate="RESTRICT" referencedColumnNames="ShieldId" referencedTableName="Shield"/>
    <addForeignKeyConstraint baseColumnNames="SystemId" baseTableName="SystemShieldUpgrade" constraintName="FK_System_SystemShieldUpgrade" deferrable="false" initiallyDeferred="false" onDelete="RESTRICT" onUpdate="RESTRICT" referencedColumnNames="SystemId" referencedTableName="System"/>
    <addForeignKeyConstraint baseColumnNames="BaseShipId" baseTableName="SystemShip" constraintName="FK_BaseShip_SystemShip" deferrable="false" initiallyDeferred="false" onDelete="RESTRICT" onUpdate="RESTRICT" referencedColumnNames="BaseShipId" referencedTableName="BaseShip"/>
    <addForeignKeyConstraint baseColumnNames="SystemId" baseTableName="SystemShip" constraintName="FK_System_SystemShip" deferrable="false" initiallyDeferred="false" onDelete="RESTRICT" onUpdate="RESTRICT" referencedColumnNames="SystemId" referencedTableName="System"/>
    <addForeignKeyConstraint baseColumnNames="SystemId" baseTableName="SystemWeaponUpgrade" constraintName="FK_System_SystemWeaponUpgrade" deferrable="false" initiallyDeferred="false" onDelete="RESTRICT" onUpdate="RESTRICT" referencedColumnNames="SystemId" referencedTableName="System"/>
    <addForeignKeyConstraint baseColumnNames="WeaponId" baseTableName="SystemWeaponUpgrade" constraintName="FK_Weapon_SystemWeaponUpgrade" deferrable="false" initiallyDeferred="false" onDelete="RESTRICT" onUpdate="RESTRICT" referencedColumnNames="WeaponId" referencedTableName="Weapon"/>
  </changeSet>
  <changeSet author="Jory Stone" id="4">
    <comment>Changing the Password column on the User table to a varbinary so we can store the hash directly instead of converting to a string for storage</comment>
    <dropColumn tableName="User" columnName="Password" />
    <addColumn tableName="User">
      <column name="Password" type="varbinary(32)">
        <constraints nullable="false"/>
      </column>
    </addColumn>
  </changeSet>
  <changeSet author="Jory Stone" id="5">
    <comment>Added a CargoCost column to the Shield table</comment>
    <addColumn tableName="Shield">
      <column name="CargoCost" type="int">
        <constraints nullable="false"/>
      </column>
    </addColumn>
  </changeSet>
  <changeSet author="Jory Stone" id="6">
    <comment>Added a TargetSystemArrivalTime column to the Ship table</comment>
    <addColumn tableName="Ship">
      <column name="TargetSystemArrivalTime" type="datetime" />
    </addColumn>
  </changeSet>
  <changeSet author="Jory Stone" id="7">
    <comment>Renamed Recieved column on the Message table to Received.</comment>
    <renameColumn tableName="Message" oldColumnName="Recieved" newColumnName="Received" />
  </changeSet>
  <changeSet author="Jory Stone" id="8">
    <comment>Adding VerificationCode, LastLogin, and LoginAttemptCount columns to the User table</comment>
    <addColumn tableName="User">
      <column name="VerificationCode" type="varchar(32)" />
      <column name="LastLogin" type="datetime" />
      <column name="LoginAttemptCount" type="int" defaultValueNumeric="0">
        <constraints nullable="false"/>
      </column>      
    </addColumn>
  </changeSet>
  <changeSet author="Jory Stone" id="9">
    <comment>Removed VerificationCode column from the User table. No need, for verification the user id would do.</comment>
    <dropColumn tableName="User" columnName="VerificationCode" />
  </changeSet>
  <changeSet author="Jory Stone" id="10">
    <comment>Added a Description column to the Race table</comment>
    <addColumn tableName="Race">
      <column name="Description" type="varchar(255)" />
    </addColumn>
  </changeSet>
  <changeSet id="0-testData" author="Jory Stone" runOnChange="true">
    <sql>
      IF NOT EXISTS (SELECT * FROM JumpDrive)
      BEGIN
      SET IDENTITY_INSERT JumpDrive ON
      INSERT INTO JumpDrive (JumpDriveId,Name,Speed,Range,CargoCost,BasePrice) VALUES (1,'Rocket',5,10,0,1000)
      INSERT INTO JumpDrive (JumpDriveId,Name,Speed,Range,CargoCost,BasePrice) VALUES (2,'Nuclear',5,15,2,10000)
      INSERT INTO JumpDrive (JumpDriveId,Name,Speed,Range,CargoCost,BasePrice) VALUES (3,'Plasma',3,15,5,25000)
      INSERT INTO JumpDrive (JumpDriveId,Name,Speed,Range,CargoCost,BasePrice) VALUES (4,'Light',1,20,10,100000)
      SET IDENTITY_INSERT JumpDrive OFF
      END;

      IF NOT EXISTS (SELECT * FROM Shield)
      BEGIN
      SET IDENTITY_INSERT Shield ON
      INSERT INTO Shield (ShieldId,Name,Strength,BasePrice,CargoCost) VALUES (1,'Force Field',10,100,1)
      SET IDENTITY_INSERT Shield OFF
      END;

      IF NOT EXISTS (SELECT * FROM Weapon)
      BEGIN
      SET IDENTITY_INSERT Weapon ON
      INSERT INTO Weapon (WeaponId,Name,Power,TurnCost,CargoCost,BasePrice) VALUES (1,'Railgun',8,2,0,1000)
      INSERT INTO Weapon (WeaponId,Name,Power,TurnCost,CargoCost,BasePrice) VALUES (2,'Laser',5,1,2,10000)
      INSERT INTO Weapon (WeaponId,Name,Power,TurnCost,CargoCost,BasePrice) VALUES (3,'Missile',15,2,5,250000)
      INSERT INTO Weapon (WeaponId,Name,Power,TurnCost,CargoCost,BasePrice) VALUES (4,'Newtonian',15,1,10,1000000)
      SET IDENTITY_INSERT Weapon OFF
      END;

      IF NOT EXISTS (SELECT * FROM BaseShip)
      BEGIN
      SET IDENTITY_INSERT BaseShip ON
      INSERT INTO BaseShip (BaseShipId,Model,BasePrice,CargoSpace,InitialJumpDriveId,InitialWeaponId,InitialShieldId) VALUES (1,'Glorified Trash Can',5000,25,1,1,1)
      INSERT INTO BaseShip (BaseShipId,Model,BasePrice,CargoSpace,InitialJumpDriveId,InitialWeaponId,InitialShieldId) VALUES (2,'Rover',25000,35,2,2,1)
      INSERT INTO BaseShip (BaseShipId,Model,BasePrice,CargoSpace,InitialJumpDriveId,InitialWeaponId,InitialShieldId) VALUES (3,'Widow Maker',750000,50,3,4,1)
      INSERT INTO BaseShip (BaseShipId,Model,BasePrice,CargoSpace,InitialJumpDriveId,InitialWeaponId,InitialShieldId) VALUES (4,'Dagger',2500000,100,4,3,1)
      INSERT INTO BaseShip (BaseShipId,Model,BasePrice,CargoSpace,InitialJumpDriveId,InitialWeaponId,InitialShieldId) VALUES (5,'Weed Wacker',10000000,255,4,4,1)
      SET IDENTITY_INSERT BaseShip OFF
      END;

      IF NOT EXISTS (SELECT * FROM Good)
      BEGIN
      SET IDENTITY_INSERT Good ON
      INSERT INTO Good (GoodId,Name,BasePrice,Contraband) VALUES (1,'FoodCubes',40,0)
      INSERT INTO Good (GoodId,Name,BasePrice,Contraband) VALUES (2,'Water',30,0)
      INSERT INTO Good (GoodId,Name,BasePrice,Contraband) VALUES (3,'Machine Parts',75,0)
      INSERT INTO Good (GoodId,Name,BasePrice,Contraband) VALUES (4,'DeathRays',150,1)
      INSERT INTO Good (GoodId,Name,BasePrice,Contraband) VALUES (5,'Zowie',100,1)
      INSERT INTO Good (GoodId,Name,BasePrice,Contraband) VALUES (6,'Fuel Rods',50,0)
      INSERT INTO Good (GoodId,Name,BasePrice,Contraband) VALUES (7,'LuvBots',125,1)
      INSERT INTO Good (GoodId,Name,BasePrice,Contraband) VALUES (8,'Fullerene',60,0)
      INSERT INTO Good (GoodId,Name,BasePrice,Contraband) VALUES (9,'Nanites',175,1)
      INSERT INTO Good (GoodId,Name,BasePrice,Contraband) VALUES (10,'Artificial Intelligences',200,0)
      SET IDENTITY_INSERT Good OFF
      END;

      IF NOT EXISTS (SELECT * FROM Race)
      BEGIN
      SET IDENTITY_INSERT Race ON
      INSERT INTO Race (RaceId,Name,Weapons,Shields,Engine,Description) VALUES (1,'Skumm',0,-1,1,'')
      INSERT INTO Race (RaceId,Name,Weapons,Shields,Engine,Description) VALUES (3,'Decapodian',0,1,-1,'You''ve got crabs!')
      INSERT INTO Race (RaceId,Name,Weapons,Shields,Engine,Description) VALUES (4,'Binarite',-1,0,0,'1010001001')
      INSERT INTO Race (RaceId,Name,Weapons,Shields,Engine,Description) VALUES (5,'Schrodinoid',1,0,0,'Don''t put me in the box')
      INSERT INTO Race (RaceId,Name,Weapons,Shields,Engine,Description) VALUES (6,'Human',1,1,-1,'Hasta la vista, baby.')
      SET IDENTITY_INSERT Race OFF
      END;

      IF NOT EXISTS (SELECT * FROM System)
      BEGIN
      SET IDENTITY_INSERT System ON
      INSERT INTO System (SystemId,Name,PositionX,PositionY,HasBank) VALUES (1,'Sol',0,0,1)
      INSERT INTO System (SystemId,Name,PositionX,PositionY,HasBank) VALUES (2,'Vance''s Folly',6,3,0)
      INSERT INTO System (SystemId,Name,PositionX,PositionY,HasBank) VALUES (3,'Glop',15,2,1)
      INSERT INTO System (SystemId,Name,PositionX,PositionY,HasBank) VALUES (4,'Sigle',20,10,1)
      INSERT INTO System (SystemId,Name,PositionX,PositionY,HasBank) VALUES (5,'Quantum 5',12,19,1)
      INSERT INTO System (SystemId,Name,PositionX,PositionY,HasBank) VALUES (6,'11111010',3,23,0)
      INSERT INTO System (SystemId,Name,PositionX,PositionY,HasBank) VALUES (7,'D2O',25,23,0)
      INSERT INTO System (SystemId,Name,PositionX,PositionY,HasBank) VALUES (8,'Last Chance',8,12,0)
      INSERT INTO System (SystemId,Name,PositionX,PositionY,HasBank) VALUES (9,'Haven',18,16,1)
      INSERT INTO System (SystemId,Name,PositionX,PositionY,HasBank) VALUES (10,'1111101000',4,15,1)
      SET IDENTITY_INSERT System OFF
      END;
    </sql>
    <!--
    <sql>
      /* Update BaseShip models will level matching upgrades */
      UPDATE BaseShip SET InitialShieldId = 2 WHERE BaseShipId = 2;
      UPDATE BaseShip SET InitialWeaponId = 3, InitialShieldId = 3 WHERE BaseShipId = 3;
      UPDATE BaseShip SET CargoSpace = 75, InitialWeaponId = 4, InitialShieldId = 4 WHERE BaseShipId = 4;
      UPDATE BaseShip SET CargoSpace = 110, InitialJumpDriveId = 5, InitialWeaponId = 5, InitialShieldId = 5 WHERE BaseShipId = 5;
    </sql>
    -->
  </changeSet>
</databaseChangeLog>
